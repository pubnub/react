{"version":3,"sources":["modules/getStatus.js"],"names":["getStatus","callback","_broadcast","status","_listener","st","isSubscribe","_component","setState","pn_status","prevState","$set","emitStatus","state"],"mappings":";;;;;QAQgBA,S,GAAAA,S;;AARhB;;;;;;AAQO,SAASA,SAAT,CAAmBC,QAAnB,EAA6B;AAAA;;AAClC,OAAKC,UAAL,CAAgBC,MAAhB,CAAuBF,QAAvB;;AAEA,MAAI,CAAC,KAAKG,SAAL,CAAeD,MAApB,EAA4B;AAC1B,SAAKC,SAAL,CAAeD,MAAf,GAAwB,UAACE,EAAD,EAAQ;AAC9B,UAAI,CAAC,MAAKH,UAAL,CAAgBI,WAAhB,CAA4B,QAA5B,CAAL,EAA4C;AAC1C,eAAO,IAAP;AACD;;AAED,YAAKC,UAAL,CAAgBC,QAAhB,CAAyB;AAAA,eAAc;AACrCC,qBAAW,kCAAOC,UAAUD,SAAjB,EAA4B,EAAEE,MAAMN,EAAR,EAA5B;AAD0B,SAAd;AAAA,OAAzB;;AAIA,YAAKH,UAAL,CAAgBU,UAAhB,CAA2BP,EAA3B;AACD,KAVD;AAWD;;AAED,MAAI,KAAKE,UAAL,CAAgBM,KAAhB,IAAyB,KAAKN,UAAL,CAAgBM,KAAhB,CAAsBJ,SAAnD,EAA8D;AAC5D,WAAO,KAAKF,UAAL,CAAgBM,KAAhB,CAAsBJ,SAA7B;AACD,GAFD,MAEO;AACL,WAAO,EAAP;AACD;AACF","file":"getStatus.js","sourcesContent":["import update from 'immutability-helper';\n\n/**\n * Get to receive status information from a channel through a callback\n *\n * @param {function} callback\n * @returns {object}\n */\nexport function getStatus(callback) {\n  this._broadcast.status(callback);\n\n  if (!this._listener.status) {\n    this._listener.status = (st) => {\n      if (!this._broadcast.isSubscribe('status')) {\n        return true;\n      }\n\n      this._component.setState(prevState => ({\n        pn_status: update(prevState.pn_status, { $set: st })\n      }));\n\n      this._broadcast.emitStatus(st);\n    };\n  }\n\n  if (this._component.state && this._component.state.pn_status) {\n    return this._component.state.pn_status;\n  } else {\n    return {};\n  }\n}\n"]}